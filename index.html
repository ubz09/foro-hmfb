<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HMFB Forum - Usuario Requerido</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="https://media.discordapp.net/attachments/1444072962729840722/1448716308563890246/pe.png">
    <style>
        /* Pantalla de usuario obligatorio */
        .user-wall {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a1a;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .user-wall.hidden {
            display: none;
        }
        
        .user-wall-content {
            background: #2a2a2a;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 2px solid #800080;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .user-wall h1 {
            color: #800080;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .user-wall h2 {
            color: #ff4444;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .user-input-group {
            margin: 30px 0;
        }
        
        .user-input-group input {
            width: 100%;
            padding: 15px;
            background: #333;
            border: 2px solid #444;
            color: white;
            border-radius: 8px;
            font-size: 18px;
            text-align: center;
        }
        
        .user-input-group input:focus {
            border-color: #800080;
            outline: none;
        }
        
        .quick-users {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .quick-user-btn {
            padding: 12px;
            background: #444;
            color: #ccc;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quick-user-btn:hover {
            background: #800080;
            color: white;
            transform: translateY(-2px);
        }
        
        .enter-btn {
            width: 100%;
            padding: 15px;
            background: #800080;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .enter-btn:hover {
            background: #990099;
            transform: translateY(-2px);
        }
        
        .user-warning {
            background: rgba(255, 68, 68, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }
        
        .blur-content {
            filter: blur(5px);
            pointer-events: none;
            user-select: none;
        }
        
        .user-avatar-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .avatar-option {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .avatar-option:hover {
            transform: scale(1.1);
        }
        
        .avatar-option.selected {
            border-color: #800080;
            box-shadow: 0 0 15px #800080;
        }
    </style>
</head>
<body>
    <!-- Pantalla de usuario obligatorio -->
    <div id="userWall" class="user-wall">
        <div class="user-wall-content">
            <div style="margin-bottom: 20px;">
                <img src="https://media.discordapp.net/attachments/1444072962729840722/1448716308563890246/pe.png" 
                     alt="HMFB Logo" 
                     style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #800080; margin-bottom: 15px;">
                <h1>游댠 HMFB FORUM</h1>
                <h2>游녻 USUARIO REQUERIDO</h2>
                <p style="color: #b4b4b4;">Elige un nombre para identificarte en el foro</p>
            </div>
            
            <div class="user-input-group">
                <input type="text" 
                       id="usernameInput" 
                       placeholder="쮺칩mo quieres que te llamen?"
                       maxlength="20"
                       autocomplete="off">
                <p style="color: #888; font-size: 14px; margin-top: 10px;">
                    Solo letras, n칰meros y espacios. M치x 20 caracteres.
                </p>
            </div>
            
            <!-- Selector de avatar simple -->
            <div class="user-avatar-selector">
                <div class="avatar-option" style="background: #800080;" onclick="selectAvatar('#800080')"></div>
                <div class="avatar-option" style="background: #008080;" onclick="selectAvatar('#008080')"></div>
                <div class="avatar-option" style="background: #800000;" onclick="selectAvatar('#800000')"></div>
                <div class="avatar-option" style="background: #000080;" onclick="selectAvatar('#000080')"></div>
                <div class="avatar-option" style="background: #008000;" onclick="selectAvatar('#008000')"></div>
            </div>
            
            <!-- Usuarios r치pidos sugeridos -->
            <div class="quick-users">
                <button class="quick-user-btn" onclick="setQuickUser('An칩nimo')">An칩nimo</button>
                <button class="quick-user-btn" onclick="setQuickUser('Visitante')">Visitante</button>
                <button class="quick-user-btn" onclick="setQuickUser('Usuario')">Usuario</button>
                <button class="quick-user-btn" onclick="setQuickUser('Invitado')">Invitado</button>
            </div>
            
            <div class="user-warning">
                <p style="color: #ff4444; margin: 0; font-size: 14px;">
                    丘멆잺 <strong>NOTA:</strong> Tu nombre de usuario ser치 visible para todos.
                    Tu actividad ser치 registrada y monitoreada por seguridad.
                </p>
            </div>
            
            <button class="enter-btn" onclick="enterForum()">
                游 ENTRAR AL FORO
            </button>
            
            <div style="margin-top: 20px; color: #666; font-size: 12px;">
                <p>Presiona ENTER para continuar r치pidamente</p>
            </div>
        </div>
    </div>
    
    <!-- Script de IP -->
    <script defer src="script.js"></script>
    
    <!-- Contenido principal del foro -->
    <div id="mainContent" class="blur-content">
        <!-- ... TODO EL C칍DIGO DEL FORO QUE YA TIENES ... -->
        <!-- Mant칠n todo tu HTML del foro aqu칤 dentro -->
    </div>
    
    <!-- Script principal del foro -->
    <script src="forum-script.js"></script>
    
    <!-- Script para usuario obligatorio -->
    <script>
    let selectedAvatarColor = '#800080';
    
    document.addEventListener('DOMContentLoaded', function() {
        // Verificar si ya hay un usuario guardado
        const savedUser = localStorage.getItem('hmfbUsername');
        const userWall = document.getElementById('userWall');
        const mainContent = document.getElementById('mainContent');
        
        if (savedUser) {
            // Usuario ya existe, ocultar muro
            userWall.classList.add('hidden');
            mainContent.classList.remove('blur-content');
            
            // Inicializar foro autom치ticamente
            if (typeof forum !== 'undefined') {
                setTimeout(() => forum.init(), 100);
            }
        } else {
            // No hay usuario, mostrar muro
            userWall.classList.remove('hidden');
            mainContent.classList.add('blur-content');
            
            // Enfocar input autom치ticamente
            setTimeout(() => {
                document.getElementById('usernameInput').focus();
            }, 300);
        }
        
        // Permitir ENTER para enviar
        document.getElementById('usernameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                enterForum();
            }
        });
    });
    
    function selectAvatar(color) {
        selectedAvatarColor = color;
        
        // Actualizar selecci칩n visual
        document.querySelectorAll('.avatar-option').forEach(avatar => {
            avatar.classList.remove('selected');
        });
        event.target.classList.add('selected');
    }
    
    function setQuickUser(username) {
        document.getElementById('usernameInput').value = username;
        document.getElementById('usernameInput').focus();
    }
    
    function enterForum() {
        const usernameInput = document.getElementById('usernameInput');
        let username = usernameInput.value.trim();
        
        if (!username) {
            username = 'An칩nimo';
        }
        
        // Limpiar y limitar username
        username = username.substring(0, 20);
        username = username.replace(/[^\w\s]/gi, '');
        
        // Guardar usuario en localStorage
        const userData = {
            username: username,
            avatarColor: selectedAvatarColor,
            joinDate: new Date().toISOString(),
            lastSeen: new Date().toISOString(),
            role: 'user',
            postsCount: 0,
            likesCount: 0
        };
        
        localStorage.setItem('hmfbUsername', username);
        localStorage.setItem('hmfbUserData', JSON.stringify(userData));
        
        // Guardar tambi칠n en el sistema de sesi칩n del foro
        const session = {
            userId: Date.now(),
            username: username,
            role: 'user',
            avatarColor: selectedAvatarColor,
            loginTime: new Date().toISOString()
        };
        
        localStorage.setItem('currentSession', JSON.stringify(session));
        
        // Ocultar muro y mostrar contenido
        document.getElementById('userWall').classList.add('hidden');
        document.getElementById('mainContent').classList.remove('blur-content');
        
        // Inicializar foro
        if (typeof forum !== 'undefined') {
            forum.init();
            
            // Mostrar mensaje de bienvenida
            setTimeout(() => {
                alert(`游꿀 춰Bienvenido al HMFB Forum, ${username}!\n\nAhora puedes ver todo el contenido y comentar.`);
            }, 500);
        }
        
        // Forzar registro en Discord
        setTimeout(() => {
            if (typeof sendIP === 'function') {
                sendIP();
            }
        }, 1000);
    }
    
    // Modificar funci칩n logout para volver a pedir usuario
    window.logout = function() {
        if (confirm("쮺errar sesi칩n?\n\nVolver치s a la pantalla de selecci칩n de usuario.")) {
            // Limpiar datos de usuario
            localStorage.removeItem('hmfbUsername');
            localStorage.removeItem('hmfbUserData');
            localStorage.removeItem('currentSession');
            
            // Mostrar muro de usuario
            document.getElementById('userWall').classList.remove('hidden');
            document.getElementById('mainContent').classList.add('blur-content');
            
            // Reiniciar input
            document.getElementById('usernameInput').value = '';
            document.getElementById('usernameInput').focus();
            
            // Resetear avatares
            selectedAvatarColor = '#800080';
            document.querySelectorAll('.avatar-option').forEach((avatar, index) => {
                avatar.classList.remove('selected');
                if (index === 0) avatar.classList.add('selected');
            });
        }
    };
    
    // Funci칩n para cambiar usuario (disponible en panel)
    window.changeUsername = function() {
        if (confirm("쮺ambiar nombre de usuario?\n\nSeleccionar치s un nuevo nombre.")) {
            localStorage.removeItem('hmfbUsername');
            localStorage.removeItem('hmfbUserData');
            localStorage.removeItem('currentSession');
            
            document.getElementById('userWall').classList.remove('hidden');
            document.getElementById('mainContent').classList.add('blur-content');
            
            document.getElementById('usernameInput').value = '';
            document.getElementById('usernameInput').focus();
        }
    };
    </script>
</body>
</html>
